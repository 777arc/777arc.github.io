
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. Digitale Modulatie &#8212; PySDR: A Guide to SDR and DSP using Python</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. PlutoSDR in Python" href="pluto.html" />
    <link rel="prev" title="3. IQ-sampling" href="sampling.html" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TGRQK1JJYD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TGRQK1JJYD');
</script>

<div style="float: right; padding-bottom: 0;">
  PySDR is now available in:&nbsp;&nbsp;
  <img src="https://pysdr.org/_static/us.svg" alt="English Version" width="20"><a href="https://pysdr.org/index.html">English</a>&nbsp;&nbsp;
  <img src="https://pysdr.org/_static/nl.svg" alt="Dutch Version" width="20"><a href="https://pysdr.org/nl/index-nl.html">Dutch</a>&nbsp;&nbsp;
  <img src="https://pysdr.org/_static/fr.svg" alt="French Version" width="20"><a href="https://pysdr.org/fr/index-fr.html">French</a>
</div>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index-nl.html">
    <img class="logo" src="../_static/logo.svg" alt="Logo"/>
    
    <h1 class="logo logo-name">PySDR: Een handleiding voor SDR en DSP met Python</h1>
    
  </a>
</p>



<p class="blurb">By <a href="https://pysdr.org/content/about_author.html">Dr. Marc Lichtman</a></p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introductie</a></li>
<li class="toctree-l1"><a class="reference internal" href="frequency_domain.html">2. Het Frequentiedomein</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">3. IQ-sampling</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Digitale Modulatie</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#symbolen">Symbolen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#draadloze-symbolen">Draadloze Symbolen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#amplitude-shift-keying-ask">Amplitude Shift Keying (ASK)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#phase-shift-keying-psk">Phase Shift Keying (PSK)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#iq-diagrammen-constellaties">IQ Diagrammen/Constellaties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quadrature-amplitude-modulation-qam">Quadrature Amplitude Modulation (QAM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#frequency-shift-keying-fsk">Frequency Shift Keying (FSK)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#differentiele-codering">Differentiële Codering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#voorbeeld-in-python">Voorbeeld in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#extra-leesmateriaal">Extra Leesmateriaal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pluto.html">5. PlutoSDR in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="usrp.html">6. USRP in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="noise.html">7. Ruis en dB</a></li>
<li class="toctree-l1"><a class="reference internal" href="filters.html">8. Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="link_budgets.html">9. Link Budgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="channel_coding.html">10. Kanaalcodering</a></li>
<li class="toctree-l1"><a class="reference internal" href="iq_files.html">11. IQ Files and SigMF</a></li>
<li class="toctree-l1"><a class="reference internal" href="multipath_fading.html">12. Multipath Fading</a></li>
<li class="toctree-l1"><a class="reference internal" href="pulse_shaping.html">13. Pulse Shaping</a></li>
<li class="toctree-l1"><a class="reference internal" href="sync.html">14. Synchronisatie</a></li>
<li class="toctree-l1"><a class="reference internal" href="rds.html">15. Compleet voorbeeld</a></li>
<li class="toctree-l1"><a class="reference internal" href="about_author.html">16. Over de auteur</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://trinket.io/embed/python3">Online Python Console</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index-nl.html">Documentation overview</a><ul>
      <li>Previous: <a href="sampling.html" title="previous chapter"><span class="section-number">3. </span>IQ-sampling</a></li>
      <li>Next: <a href="pluto.html" title="next chapter"><span class="section-number">5. </span>PlutoSDR in Python</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="sampling.html" title="Previous document"><span class="section-number">3. </span>IQ-sampling</a>
        </li>
        <li>
          <a href="pluto.html" title="Next document"><span class="section-number">5. </span>PlutoSDR in Python</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <div class="section" id="digitale-modulatie">
<span id="modulation-chapter"></span><h1><span class="section-number">4. </span>Digitale Modulatie<a class="headerlink" href="#digitale-modulatie" title="Permalink to this headline">¶</a></h1>
<p>In dit hoofdstuk gaan we met behulp van digitale modulatie data <em>echt versturen</em> en draadloze symbolen behandelen! We gaan signalen ontwerpen die “informatie” bevatten, dus 1’en en 0’en, door gebruik van modulatietechnieken zoals ASK, PSK, QAM en FSK. We zullen ook IQ-diagrammen en constellaties behandelen en het hoofdstuk afsluiten met wat Python voorbeelden.</p>
<p>Het grote doel van moduleren is om zoveel mogelijk data in een zo klein mogelijk spectrum te proppen. Technisch gezegd willen we de “spectrale efficiëntie” (bits/sec/Hz) maximaliseren. 1’en en 0’en sneller versturen zal de bandbreedte van ons signaal groter doen maken (denk aan de <a class="reference internal" href="frequency_domain.html#tijd-frequentie-eigenschappen"><span class="std std-ref">Tijd-Frequentie Eigenschappen</span></a>), wat betekent dat meer van het spectrum wordt gebruikt. Naast snellere transmissie zullen we ook andere technieken bekijken. Er zijn veel afwegingen voor de modulatiekeuze, maar er is ook vrijheid voor creativiteit.</p>
<div class="section" id="symbolen">
<h2>Symbolen<a class="headerlink" href="#symbolen" title="Permalink to this headline">¶</a></h2>
<p>Waarschuwing: nieuwe term! Het uitgaande signaal zal worden opgebouwd uit “symbolen”. Elk symbool zal een aantal bits aan informatie bevatten en we willen symbolen achter elkaar versturen, duizenden of miljoenen in een rij.</p>
<p>Als een versimpeld voorbeeld, laten we zeggen dat we 1’en en 0’en sturen met hoge en lage spanningsniveaus. Een symbool is zo’n 1 of 0:</p>
<a class="reference internal image-reference" href="../_images/symbols.png"><img alt="../_images/symbols.png" class="align-center" src="../_images/symbols.png" style="width: 602.4px; height: 102.0px;" /></a>
<p>In het bovenstaande voorbeeld stelt een symbool slechts een bit voor. Hoe kunnen we meerdere bits per symbool overbrengen? Laten we gaan kijken hoe signalen over ethernetkabels worden gestuurd, dit is vastgelegd in een IEEE standaard genaamd IEEE 802.3 1000BASE-T. In normale situaties gebruikt ethernet amplitudemodulatie met 4 niveaus (2 bits per symbool) en 8 ns symbolen.</p>
<a class="reference external image-reference" href="../_images/ethernet.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/ethernet.svg" class="align-center" src="../_images/ethernet.svg" /></a>
<p>Neem een moment om deze vragen te beantwoorden:</p>
<ol class="arabic simple">
<li>Hoeveel bits per seconde worden overgestuurd in het bovenstaande voorbeeld?</li>
<li>Hoeveel data-draden zouden nodig zijn om 1 gigabit/sec te versturen?</li>
<li>Als een modulatieschema 16 verschillende niveaus heeft, hoeveel bits per symbool is dat?</li>
<li>Met 16 verschillende niveaus en 8ns symbolen, hoeveel bits per seconde is dat?</li>
</ol>
<details>
<summary>Antwoorden</summary><ol class="arabic simple">
<li>250 Mbps - (1/8e-9)*2</li>
<li>Vier (wat ethernet kabels ook hebben)</li>
<li>4 bits per symbool - log_2(16)</li>
<li>0.5 Gbps - (1/8e-9)*4</li>
</ol>
</details></div>
<div class="section" id="draadloze-symbolen">
<h2>Draadloze Symbolen<a class="headerlink" href="#draadloze-symbolen" title="Permalink to this headline">¶</a></h2>
<p>Vraag: Waarom kunnen we het ethernet signaal van hierboven niet direct versturen? Er zijn vele redenen, maar de belangrijkste zijn:</p>
<ol class="arabic simple">
<li>Lage frequenties hebben <em>enorme</em> antennes nodig</li>
<li>Blokgolven nemen voor het aantal bits-per-seconde een <em>overbodige</em> hoeveelheid ruimte van het spectrum in – herinner van het  <a class="reference internal" href="frequency_domain.html#freq-domain-chapter"><span class="std std-ref">Het Frequentiedomein</span></a> hoofdstuk dat scherpe veranderingen in het tijddomein een grote hoeveelheid bandbreedte/spectrum gebruiken:</li>
</ol>
<a class="reference external image-reference" href="../_images/square-wave.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/square-wave.svg" class="align-center" src="../_images/square-wave.svg" /></a>
<p>Wat we voor draadloze signalen doen is beginnen met een draaggolf, wat gewoon een sinusoïde is. FM-radio gebruikt bijvoorbeeld een draaggolf als 101.1 MHz of 100.3 MHz. We moduleren die draaggolf op een bepaalde manier (er zijn vele). In geval van FM-radio is dit analoge modulatie, niet digitaal, maar het concept is hetzelfde als bij digitale modulatie.</p>
<p>Op wat voor manier kunnen we de draaggolf moduleren? Een andere manier om dit te vragen is: Wat zijn de verschillende eigenschappen van een sinusoïde?</p>
<ol class="arabic simple">
<li>Amplitude</li>
<li>Fase</li>
<li>Frequentie</li>
</ol>
<p>Door een of meerdere van deze drie aan te passen kunnen we data op een draaggolf moduleren.</p>
</div>
<div class="section" id="amplitude-shift-keying-ask">
<h2>Amplitude Shift Keying (ASK)<a class="headerlink" href="#amplitude-shift-keying-ask" title="Permalink to this headline">¶</a></h2>
<p>Amplitude Shift Keying (ASK) (Nederlands: amplitudeverschuivingsmodulatie) is het eerste digitale modulatieschema dat we zullen bespreken want het is van de drie sinusoïde eigenschappen het simpelst te visualiseren. We moduleren letterlijk de <strong>amplitude</strong> van de draaggolf. Hier is een voorbeeld van ASK met 2 niveaus, genaamd 2-ASK:</p>
<a class="reference external image-reference" href="../_images/ASK.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/ASK.svg" class="align-center" src="../_images/ASK.svg" /></a>
<p>Let op hoe de gemiddelde waarde nul is; dit heeft altijd onze voorkeur.</p>
<p>We kunnen meer dan twee niveaus gebruiken om meer bits per symbool te versturen. Hieronder een voorbeeld van 4-ASK. In dit geval bevat elk symbool 2 bits aan informatie.</p>
<a class="reference external image-reference" href="../_images/ask2.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/ask2.svg" class="align-center" src="../_images/ask2.svg" /></a>
<p>Vraag: Hoeveel symbolen kun je in het signaal hierboven onderscheiden? Hoeveel bits worden in totaal verzonden?</p>
<details>
<summary>Antwoorden</summary><p>20 symbolen, dus 40 bits aan informatie</p>
</details><p>Hoe kunnen we eigenlijk dit signaal met code creëren?
Het enige wat we hoeven te doen, is een vector van N samples per symbool maken, en dat vermenigvuldigen met een sinusoïde.
Dit moduleert ons signaal op de draaggolf (de sinusoïde is die draaggolf). Het voorbeeld hieronder laat 2-ASK zien met 10 symbolen per seconde.</p>
<a class="reference external image-reference" href="../_images/ask3.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/ask3.svg" class="align-center" src="../_images/ask3.svg" /></a>
<p>Het bovenste figuur laat de discrete samples zien als rode punten, dus ons digitale signaal. Het onderste figuur laat zien hoe het resulterende gemoduleerde signaal eruitziet, dit zou door de lucht verzonden kunnen worden.
In echte systemen is de frequentie van de draaggolf veel hoger dan de snelheid waarmee de symbolen afwisselen. In ons voorbeeld zijn er maar 3 perioden van de draaggolf per symbool, maar in de praktijk zouden er duizenden kunnen zijn, afhankelijk van hoe hoog in het spectrum het verzonden wordt.</p>
</div>
<div class="section" id="phase-shift-keying-psk">
<h2>Phase Shift Keying (PSK)<a class="headerlink" href="#phase-shift-keying-psk" title="Permalink to this headline">¶</a></h2>
<p>Laten we overwegen om de fase op dezelfde manier te moduleren als we met de amplitude hebben gedaan. De simpelste vorm is Binaire PSK (BPSK) waar er twee faseniveaus zijn:</p>
<ol class="arabic simple">
<li>Geen faseverandering</li>
<li>180 graden faseverandering</li>
</ol>
<p>Voorbeeld van BPSK (let op de faseveranderingen):</p>
<a class="reference external image-reference" href="../_images/bpsk.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/bpsk.svg" class="align-center" src="../_images/bpsk.svg" /></a>
<p>Het is niet zo leuk om naar figuren te kijken als deze:</p>
<a class="reference external image-reference" href="../_images/bpsk2.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/bpsk2.svg" class="align-center" src="../_images/bpsk2.svg" /></a>
<p>In plaats daarvan laten we de fase meestal zien in het complexe vlak.</p>
</div>
<div class="section" id="iq-diagrammen-constellaties">
<h2>IQ Diagrammen/Constellaties<a class="headerlink" href="#iq-diagrammen-constellaties" title="Permalink to this headline">¶</a></h2>
<p>Je hebt al eerder complexe nummers in IQ-diagrammen gezien in het <a class="reference internal" href="sampling.html#complexe-getallen"><span class="std std-ref">Complexe Getallen</span></a> deel, maar nu gaan we ze op een nieuwe en grappige manier gebruiken.
We kunnen de amplitude en fase in een IQ-diagram laten zien voor een gegeven symbool.
In geval van het BPSK-voorbeeld hadden we fasen van 0 en 180 graden.
Laten we die punten eens plaatsen in het IQ-diagram.
We gaan uit van een modulus/amplitude van 1.
In de praktijk maakt het niet echt uit welke modulus je gebruikt; een hogere waarde betekent een hoger signaalvermogen, je zou ook gewoon de versterking hoger kunnen zetten.</p>
<a class="reference internal image-reference" href="../_images/bpsk_iq.png"><img alt="../_images/bpsk_iq.png" class="align-center" src="../_images/bpsk_iq.png" style="width: 384.0px; height: 316.0px;" /></a>
<p>Het bovenstaande IQ-diagram laat zien wat, of eigenlijk de set van symbolen waaruit, we versturen.
Het laat de draaggolf niet zien, dus je kunt dit zien als basisband-symbolen.
Wanneer we voor een modulatieschema de mogelijke set van symbolen laten zien, noemen we dat de “constellatie”.
Vele modulatieschema’s kunnen door hun constellaties worden gedefinieerd.</p>
<p>Om BPSK te ontvangen en decoderen kunnen we IQ-sampling toepassen, zoals we hebben geleerd in het vorige hoofdstuk, en bekijken waar de punten terechtkomen in het IQ-diagram.
Door het draadloze kanaal zal er echter wel een willekeurige faserotatie plaatsvinden, want het signaal loopt een willekeurige vertraging op wanneer het zich door de lucht en tussen de antennes voortplant.
Verschillende methodes waar we later over leren kunnen deze willekeurige faserotatie tenietdoen.
Hier zijn een paar voorbeelden van hoe het BPSK-signaal eruit zou kunnen zien bij de ontvanger (zonder ruis).</p>
<a class="reference internal image-reference" href="../_images/bpsk3.png"><img alt="../_images/bpsk3.png" class="align-center" src="../_images/bpsk3.png" style="width: 732.6px; height: 217.79999999999998px;" /></a>
<p>Terug naar PSK. Wat als we vier verschillende fasen zouden willen? Bijv., 0, 90, 180 en 270 graden.
Dat zou als volgt getoond kunnen worden in het IQ-diagram, dit vormt het Quadrature Phase Shift Keying (QPSK) schema:</p>
<a class="reference internal image-reference" href="../_images/qpsk.png"><img alt="../_images/qpsk.png" class="align-center" src="../_images/qpsk.png" style="width: 706.1999999999999px; height: 240.0px;" /></a>
<p>We hebben voor PSK altijd N verschillende hoeken/fasen, voor het beste resultaat evenredig over de 360 graden verdeeld.
Meestal laten we ook de eenheidscirkel zien om aan te geven dat alle punten dezelfde modulus hebben:</p>
<a class="reference internal image-reference" href="../_images/psk_set.png"><img alt="../_images/psk_set.png" class="align-center" src="../_images/psk_set.png" style="width: 733.1999999999999px; height: 246.6px;" /></a>
<p>Vraag: Is er wat mis met het gebruik van het onderstaande PSK-schema? Is dit een PSK-modulatieschema?</p>
<a class="reference internal image-reference" href="../_images/weird_psk.png"><img alt="../_images/weird_psk.png" class="align-center" src="../_images/weird_psk.png" style="width: 216.6px; height: 225.6px;" /></a>
<details>
<summary>Antwoord</summary><p>Er is niets onmogelijks aan dit PSK-schema. Je kunt het zeker gebruiken, maar, het schema is niet zo effectief als mogelijk omdat de symbolen niet uniform verdeeld zijn.
Wanneer we ruis op onze symbolen gaan behandelen wordt schema-efficiëntie duidelijk.
Het korte antwoord is dat we zoveel mogelijk ‘ruimte’ tussen de symbolen willen houden voor het geval er ruis is, zodanig dat bij de ontvanger een symbool niet als een van de andere (incorrecte) symbolen wordt opgevat.
We willen niet een 0 ontvangen als een 1.</p>
</details><p>Even terug naar ASK. Net als PSK kun je ASK ook laten zien in het IQ-diagram. Hier is het IQ-diagram van 2-ASK, 4-ASK, en 8-ASK, in bipolaire vorm, en ook 2-ASK en 4-ASK in de unipolaire vorm.</p>
<a class="reference internal image-reference" href="../_images/ask_set.png"><img alt="../_images/ask_set.png" class="align-center" src="../_images/ask_set.png" style="width: 642.5px; height: 370.0px;" /></a>
<p>Misschien is het je al opgevallen, de bipolaire 2-ASK en BPSK zijn hetzelfde. Een fasedraaiing van 180 graden is hetzelfde als een sinusoïde vermenigvuldigen met -1. We noemen het waarschijnlijk BPSK omdat dit veel meer wordt gebruikt dan ASK.</p>
</div>
<div class="section" id="quadrature-amplitude-modulation-qam">
<h2>Quadrature Amplitude Modulation (QAM)<a class="headerlink" href="#quadrature-amplitude-modulation-qam" title="Permalink to this headline">¶</a></h2>
<p>En wat gebeurt er als we ASK en PSK combineren? Dit modulatieschema noemen we Quadrature Amplitude Modulation (QAM) (Nederlands: kwadratuuramplitudemodulatie). QAM ziet er meestal ongeveer zo uit:</p>
<a class="reference internal image-reference" href="../_images/64qam.png"><img alt="../_images/64qam.png" class="align-center" src="../_images/64qam.png" style="width: 276.3px; height: 282.6px;" /></a>
<p>En nog wat voorbeelden van QAM:</p>
<a class="reference internal image-reference" href="../_images/qam.png"><img alt="../_images/qam.png" class="align-center" src="../_images/qam.png" style="width: 695.5px; height: 236.5px;" /></a>
<p>Technisch gezien, omdat de fase <em>en</em> amplitude gemoduleerd worden, kunnen we voor QAM de punten op het IQ-diagram plaatsen waar we willen.
Voor een gegeven QAM-schema zijn de “parameters” het best te beschrijven met een QAM-constellatie.
Aan de andere kant zou je de I en Q waarden voor elk punt kunnen beschrijven, zoals hieronder voor QPSK:</p>
<a class="reference internal image-reference" href="../_images/qpsk_list.png"><img alt="../_images/qpsk_list.png" class="align-center" src="../_images/qpsk_list.png" style="width: 308.8px; height: 215.20000000000002px;" /></a>
<p>Hierbij de opmerking dat de meeste modulatieschema’s, behalve sommige ASK’s en BPSK, vrij moeilijk in het tijddomein zijn te herkennen.
Om dit punt thuis te brengen is hier een voorbeeld van hoe QAM in het tijddomein eruitziet.
Kun jij in het onderstaande figuur van elk symbool de fase onderscheiden?
Dat is lastig.</p>
<a class="reference internal image-reference" href="../_images/qam_time_domain.png"><img alt="../_images/qam_time_domain.png" class="align-center" src="../_images/qam_time_domain.png" style="width: 658.0px; height: 148.0px;" /></a>
<p>Gezien de uitdaging om in het tijddomein modulatieschema’s te herkennen, gebruiken we liever IQ-diagrammen dan een tijddomein figuur.
Toch zouden we een tijddomein-signaal laten zien wanneer een bepaalde pakketopbouw of volgorde van symbolen van invloed is.</p>
</div>
<div class="section" id="frequency-shift-keying-fsk">
<h2>Frequency Shift Keying (FSK)<a class="headerlink" href="#frequency-shift-keying-fsk" title="Permalink to this headline">¶</a></h2>
<p>De laatste op ons lijstje is Frequency Shift Keying (FSK) (Nederlands: Frequentieverschuivingsmodulatie).
FSK is niet moeilijk te vatten – we schuiven tussen N frequenties waarbij elke frequentie een symbool voorstelt. Omdat we een draaggolf moduleren, is het eigenlijk de draaggolffrequentie +/- deze N frequenties. Als we bijv. een draaggolf hebben van 1.2 GHz, dan zouden we kunnen schuiven tussen deze vier frequenties:</p>
<ol class="arabic simple">
<li>1.2005 GHz</li>
<li>1.2010 GHz</li>
<li>1.1995 GHz</li>
<li>1.1990 GHz</li>
</ol>
<p>Dit zou dan om 4-FSK met twee bits per symbool gaan.
In het frequentiedomein zou 4-FSK er zo uit kunnen zien:</p>
<a class="reference external image-reference" href="../_images/fsk.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/fsk.svg" class="align-center" src="../_images/fsk.svg" /></a>
<p>Een belangrijke vraag die je jezelf moet stellen is: Welke afstand moet ik tussen de frequenties aanhouden?
Deze afstand wordt vaak aangegeven als <img class="math" src="../_images/math/32174248216c37ca883a89a6883863fa3225d71e.svg" alt="\Delta f"/> in Hz.
We willen vermijden dat signalen in het frequentiedomein overlappen, dus <img class="math" src="../_images/math/32174248216c37ca883a89a6883863fa3225d71e.svg" alt="\Delta f"/> moet groot genoeg zijn.
De bandbreedte van elke draaggolf is een functie van de symboolsnelheid.
Meer symbolen per seconde geeft kortere symbolen en dus een grotere bandbreedte (denk aan de inverse relatie tussen tijd en frequentie).
Hoe sneller we symbolen gaan oversturen, hoe breder elke draaggolf wordt en dus hoe groter we <img class="math" src="../_images/math/32174248216c37ca883a89a6883863fa3225d71e.svg" alt="\Delta f"/> moeten maken om te voorkomen dat de draaggolven elkaar overlappen.</p>
<a class="reference external image-reference" href="../_images/fsk2.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/fsk2.svg" class="align-center" src="../_images/fsk2.svg" /></a>
<p>Als bijzaak, FM-radio gebruikt frequentiemodulatie (FM).
Dit is een analoge versie van FSK.
In plaats van het springen tussen discrete frequenties, gebruikt de FM-zender een continu audiosignaal waarmee het de frequentie van de draaggolf moduleert.
Hieronder is een voorbeeld te zien van FM- en AM-modulatie, waarbij het “signaal” waarmee gemoduleerd wordt, in het bovenste figuur te zien is.</p>
<a class="reference external image-reference" href="../_images/Carrier_Mod_AM_FM.webp" rel="noopener noreferrer" target="_blank"><img alt="../_images/Carrier_Mod_AM_FM.webp" class="align-center" src="../_images/Carrier_Mod_AM_FM.webp" /></a>
<p>In dit boek maken we ons vooral druk over de digitale vormen van modulatie.</p>
</div>
<div class="section" id="differentiele-codering">
<h2>Differentiële Codering<a class="headerlink" href="#differentiele-codering" title="Permalink to this headline">¶</a></h2>
<p>Je zult waarschijnlijk in de meeste draadloze (en bedraade) communicatieprotocollen tegen iets aanlopen wat differentiële codering wordt genoemd.
Om het nut hiervan aan te tonen, gaan we naar de ontvangst van een BPSK-signaal kijken.
Zoals eerder verteld, wanneer dit signaal door de lucht vliegt ervaart het een willekeurige vertraging tussen zender en ontvanger, dit veroorzaakt een willekeurige draaiing/rotatie in de constellatie.
De ontvanger zal nu proberen te synchroniseren en de BPSK uit te lijnen met de I-as, maar het heeft geen idee of het 180 graden uit fase loopt of niet, de constellaties zien er exact hetzelfde uit.</p>
<p>In plaats van absolute symbolen te versturen om absoluut aan te geven wat een 1 of 0 voorstelt, kan het kiezen om differentiële codering toe te passen en zich hier niet eens zorgen om te maken.</p>
<p>De meest eenvoudige vorm van differentiële codering, wat door D-BPSK wordt gebruikt, is om een 0 te versturen wanneer de huidige ingangsbit gelijk is aan de vorige uitgangsbit, en een 1 te versturen als de huidig ingangsbit anders is dan de vorige uitgangsbit.
We sturen nog steeds dezelfde hoeveelheid bits (plus een extra om de reeks te starten) maar we hoeven ons niet meer druk te maken over een mogelijke 180 graden draaiing.</p>
<p>Laten we naar een voorbeeld kijken om aan te geven hoe dit werkt.
Stel we versturen [1, 1, 0, 0, 1, 1, 1] met BPSK.
We beginnen de uitgangsreeks met een 1; dit maakt niets uit, 1 of 0.
Na het toepassen van de differentiële codering versturen we uiteindelijk [1, 0, 1, 1, 1, 0, 1, 0].
De 1’en en 0’en worden nog steeds aan de positieve (1+0j) en negatieve (-1+0j) symbolen gekoppeld.
Dit is makkelijker voor te stellen wanneer we de in- en uitgangsreeksen op elkaar stapelen:</p>
<a class="reference external image-reference" href="../_images/differential_coding.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/differential_coding.svg" class="align-center" src="../_images/differential_coding.svg" /></a>
<p>Het grote nadeel van differentiële codering is dat een verkeerde bit tot twee bitfouten zal leiden.
Een alternatief voor differentiële codering is om periodiek piloot-symbolen te sturen, dit zijn symbolen die de ontvanger al kent, hiermee zou de ontvanger kunnen herkennen of er een faseverschuiving van 180 graden heeft plaatsgevonden.
Het probleem met deze oplossing is dat een draadloos kanaal snel kan veranderen, helemaal als de zender/ontvanger in beweging zijn, dus dan moet je die piloot-symbolen vaak genoeg versturen om dit te kunnen verhelpen.
Differentiële codering is veel eenvoudiger om te implementeren, dus als eenvoud belangrijker is dan hier en daar een verloren bit, dan zal dit de voorkeur hebben.
In het :ref:<a href="#id1"><span class="problematic" id="id2">`</span></a>rds-chapter`hoofdstuk, behandelen we RDS, dit gebruikt dus de (minder complexe) differentiële codering.</p>
</div>
<div class="section" id="voorbeeld-in-python">
<h2>Voorbeeld in Python<a class="headerlink" href="#voorbeeld-in-python" title="Permalink to this headline">¶</a></h2>
<p>Laten we als voorbeeld QPSK in de basisband genereren en in een constellatiediagram tonen met Python.</p>
<p>We zouden een lijstje van complexe symbolen kunnen intypen, maar laten we beginnen met het feit dat QPSK vier symbolen heeft met afstanden van 90-graden op de eenheidscirkel.
We gaan 45, 135, 225 en 315 graden gebruiken voor onze punten/symbolen.
Voordat we het omzetten naar radialen zullen we eerst een duizend symbolen genereren, die willekeurig een getal krijgen tussen de 0 en 3.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">aantal_symbolen</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">x_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">aantal_symbolen</span><span class="p">)</span> <span class="c1"># 0 tm 3</span>
<span class="n">x_graden</span> <span class="o">=</span> <span class="n">x_int</span><span class="o">*</span><span class="mi">360</span><span class="o">/</span><span class="mf">4.0</span> <span class="o">+</span> <span class="mi">45</span> <span class="c1"># 45, 135, 225, 315 graden</span>
<span class="n">x_radialen</span> <span class="o">=</span> <span class="n">x_graden</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span> <span class="c1"># sin() en cos() willen radialen</span>
<span class="n">x_symbolen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x_radialen</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x_radialen</span><span class="p">)</span> <span class="c1"># Dit genereert onze complexe QPSK symbolen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x_symbolen</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">x_symbolen</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="../_images/qpsk_python.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/qpsk_python.svg" class="align-center" src="../_images/qpsk_python.svg" /></a>
<p>Zie hoe alle symbolen overlappen?
Er is geen ruis dus de symbolen hebben exact dezelfde waarden.
We gaan wat ruis toevoegen:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">aantal_symbolen</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">aantal_symbolen</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># AWGN met vermogen van 1</span>
<span class="n">ruisvermogen</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">x_symbolen</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ruisvermogen</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference external image-reference" href="../_images/qpsk_python2.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/qpsk_python2.svg" class="align-center" src="../_images/qpsk_python2.svg" /></a>
<p>De additieve witte Gaussische ruis (AWGN) veroorzaakt een spreiding rondom elk constellatiepunt.
Ruis wordt behandeld in het <a class="reference internal" href="noise.html#gaussische-ruis"><span class="std std-ref">Gaussische Ruis</span></a> hoofdstuk.
Het punt is, als er te veel ruis wordt toegevoegd dan zullen sommige symbolen/samples over de grens (de vier kwadranten) gaan en incorrect geïnterpreteerd worden.
Probeer dit zelf uit door het ruisvermogen toe te laten nemen.</p>
<p>Je zou ook de faseruis kunnen simuleren, wat door variaties in de lokale oscillator (LO) zou kunnen ontstaan, door <code class="code docutils literal notranslate"><span class="pre">r</span></code> te vervangen met:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fase_ruis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_symbolen</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="c1"># de &quot;kracht&quot; van de faseruis verandert met de vermenigvuldingsfactor</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">x_symbolen</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">fase_ruis</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference external image-reference" href="../_images/phase_jitter.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/phase_jitter.svg" class="align-center" src="../_images/phase_jitter.svg" /></a>
<p>Je zou zelfs AWGN kunnen combineren met de faseruis om het probleem volledig te ervaren:</p>
<a class="reference external image-reference" href="../_images/phase_jitter_awgn.svg" rel="noopener noreferrer" target="_blank"><img alt="../_images/phase_jitter_awgn.svg" class="align-center" src="../_images/phase_jitter_awgn.svg" /></a>
<p>We gaan op dit punt stoppen.
Als we de tijddomein-versie van het QPSK-signaal zouden willen zien dan zouden we meerdere samples per symbool moeten genereren (in dit voorbeeld was het 1 sample per symbool).
Wanneer we het over pulsvorming gaan hebben zul je leren hoe je meerdere samples per symbool genereert.
Het Python-voorbeeld in het <a class="reference internal" href="pulse_shaping.html#pulse-shaping-chapter"><span class="std std-ref">Pulse Shaping</span></a> hoofdstuk zal verder gaan waar we nu zijn gestopt.</p>
</div>
<div class="section" id="extra-leesmateriaal">
<h2>Extra Leesmateriaal<a class="headerlink" href="#extra-leesmateriaal" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Differential_coding" rel="noopener noreferrer" target="_blank">https://en.wikipedia.org/wiki/Differential_coding</a></li>
</ol>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="sampling.html" title="Previous document"><span class="section-number">3. </span>IQ-sampling</a>
        </li>
        <li>
          <a href="pluto.html" title="Next document"><span class="section-number">5. </span>PlutoSDR in Python</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2023, Marc Lichtman.
      
    </div>

    

    
  </body>
</html>